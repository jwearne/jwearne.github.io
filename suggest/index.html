<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>xx  - xx</title>
    <meta name="description" content="xx">
    <meta name="author" content="xx">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="xxx - xxx">
    <meta property="og:site_name" content="xx">
    <meta property="og:url" content="xxx">
    <meta property="og:image" content="xxx">
    
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon.png">

    <link rel="stylesheet" href="css/normalise.css" type="text/css"/>
    <link rel="stylesheet" href="css/css.css" type="text/css"/>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

</head>
<body>
<div id="app-wrapper">
<header>
    <h1>Heading 1</h1>
    <h2>Heading 2</h2>
    <h3>Heading 3</h3>
</header>
<!--    
    <script type="text/javascript">
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRf65N0A-e-jUdxhZMurgOiKGwsijBtBYqLnDxgKBtZCrzEapZGAJsgbI-f0A0I_NEZRhN3v4uvq1-t/pub?output=csv';

      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: showInfo
        })
      }

      window.addEventListener('DOMContentLoaded', init)

      function showInfo(results) {
        var data = results.data

        // data comes through as a simple array since simpleSheet is turned on
        document.getElementById("data").innerHTML = "<strong>Title:</strong> " + [ data[0].Name, data[1].Name, data[2].Name ].join(", ");
        console.log(data);

        var html = '';
          
        for (var i = 0; i < data.length; i++) {
          html += '<tr>';
          html += '<td>' + data[i].title + '</td>';
          html += '<td>' + data[i].description + '</td>';
          html += '</tr>';
        }
        document.getElementById('data').innerHTML = '<table>' + html + '</table>';

      }

      document.write("The published spreadsheet is located at <a target='_new' href='" + public_spreadsheet_url + "'>" + public_spreadsheet_url + "</a>");        
    </script>
    <div id="data"></div>

    -->

<!-- randomly generates -->
    <script>
    // Parse the Google Sheet using Papa Parse

    Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vRf65N0A-e-jUdxhZMurgOiKGwsijBtBYqLnDxgKBtZCrzEapZGAJsgbI-f0A0I_NEZRhN3v4uvq1-t/pub?output=csv', 
    {
      download: true,
      header: true,
      complete: function(results) 
        {
            // Extract the cells in column 1

            var cells = results.data.map(function(row) {
              return row['title'];
            });

            // Display a random cell in a div

            if (cells.length > 0) {
              var randomIndex = Math.floor(Math.random() * cells.length);
              var randomCell = cells[randomIndex];
              document.getElementById('myDiv').textContent = randomCell;
            } else {
              document.getElementById('myDiv').textContent = 'No data found';
            }
        },
      error: function(error) {
        document.getElementById('myDiv').textContent = 'Error: ' + error.message;
      }
    });

    </script>

<!-- randomly generates using a button -->
    
<button onclick="generateRandom()">Generate Random Cell</button>
	<div id="myDiv"></div>

	<script>
		function generateRandom() {
			// Parse the Google Sheet using Papa Parse
			Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vRf65N0A-e-jUdxhZMurgOiKGwsijBtBYqLnDxgKBtZCrzEapZGAJsgbI-f0A0I_NEZRhN3v4uvq1-t/pub?output=csv', {
				download: true,
				header: true,
				complete: function(results) {
					// Extract the cells in column 1
					var cells = results.data.map(function(row) {
						return row['title'];
					});

					// Display a random cell in a div
					if (cells.length > 0) {
						var randomIndex = Math.floor(Math.random() * cells.length);
						var randomCell = cells[randomIndex];
						document.getElementById('myDiv').textContent = randomCell;
					} else {
						document.getElementById('myDiv').textContent = 'No data found';
					}
				},
				error: function(error) {
					document.getElementById('myDiv').textContent = 'Error: ' + error.message;
				}
			});
		}
	</script>
    
    <div id="myDiv"></div>
    
<!-- randomly generates a new div each time -->
    
    <button onclick="generateRandom()">Generate Random new Cell</button>
	<div id="container"></div>

	<script>
		function generateRandom() {
			// Parse the Google Sheet using Papa Parse
			Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vRf65N0A-e-jUdxhZMurgOiKGwsijBtBYqLnDxgKBtZCrzEapZGAJsgbI-f0A0I_NEZRhN3v4uvq1-t/pub?output=csv', {
				download: true,
				header: true,
				complete: function(results) {
					// Extract the cells in column 1
					var cells = results.data.map(function(row) {
						return row['title'];
					});

					// Display a random cell in a new div
					if (cells.length > 0) {
						var randomIndex = Math.floor(Math.random() * cells.length);
						var randomCell = cells[randomIndex];
						var newDiv = document.createElement('div');
						newDiv.textContent = randomCell;
						document.getElementById('container').appendChild(newDiv);
					} else {
						document.getElementById('container').textContent = 'No data found';
					}
				},
				error: function(error) {
					document.getElementById('container').textContent = 'Error: ' + error.message;
				}
			});
		}
	</script>
    
    
    
    <!-- no repeat -->
    

	<button onclick="generateRandom()">Generate Random Cell - no repeat</button>
	<div id="myDivNoRepeat"></div>

	<script>
		var cells = []; // Keep track of cells to prevent repeats

		function generateRandom() {
			// Parse the Google Sheet using Papa Parse
			Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vRf65N0A-e-jUdxhZMurgOiKGwsijBtBYqLnDxgKBtZCrzEapZGAJsgbI-f0A0I_NEZRhN3v4uvq1-t/pub?output=csv', {
				download: true,
				header: true,
				complete: function(results) {
					// Extract the cells in column 1
					var allCells = results.data.map(function(row) {
						return row['title'];
                        return row['description'];
					});

					// Filter out cells that have already been displayed
					var unusedCells = allCells.filter(function(cell) {
						return !cells.includes(cell);
					});

					if (unusedCells.length === 0) {
						// Reset cells array if all cells have been displayed
						cells = allCells.slice();
					}

					// Display a random unused cell in a div
					if (unusedCells.length > 0) {
						var randomIndex = Math.floor(Math.random() * unusedCells.length);
						var randomCell = unusedCells[randomIndex];
						cells.push(randomCell); // Add displayed cell to cells array
						document.getElementById('myDivNoRepeat').textContent = randomCell;
					} else {
						document.getElementById('myDivNoRepeat').textContent = 'All cells have been displayed';
					}
				},
				error: function(error) {
					document.getElementById('myDivNoRepeat').textContent = 'Error: ' + error.message;
				}
			});
		}
	</script>


<footer></footer>
</div>

</body>
</html>